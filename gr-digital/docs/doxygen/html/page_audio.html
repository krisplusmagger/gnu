<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GNU Radio C++ API Reference: Audio Interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/SVG"],
});
</script>
<script type="text/javascript" async="async" src="/usr/share/javascript/mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="gnuradio_logo_icon.png"/></td>
  <td id="projectalign">
   <div id="projectname">GNU Radio C++ API Reference<span id="projectnumber">&#160;v3.11.0.0git-829-g889721a8</span>
   </div>
   <div id="projectbrief">The Free &amp; Open Software Radio Ecosystem</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('page_audio.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Audio Interface</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="audio_introduction"></a>
Introduction</h1>
<p>The gnuradio audio component provides <a class="el" href="classgr_1_1audio_1_1source.html" title="Creates a source from an audio device.">gr::audio::source</a> and <a class="el" href="classgr_1_1audio_1_1sink.html" title="Creates a sink from an audio device.">gr::audio::sink</a> blocks. The audio blocks stream floating point samples to and from audio hardware.</p>
<p>The gr-audio component will be built automatically when gnuradio-runtime is enabled. Support for underlying audio architectures depends on OS and installed libraries. At the time of writing, gr-audio supports OSS, ALSA, Jack, Portaudio, Audiounit, and Winmm.</p>
<p>At runtime, gr-audio will automatically select from the available architectures. The user can override the selection via configuration file by setting "audio_module" to one of the following strings:</p>
<ul>
<li>oss </li>
<li>alsa </li>
<li>jack </li>
<li>portaudio </li>
<li>osx </li>
<li>windows</li>
</ul>
<p>See gr-audio.conf for an example.</p>
<p>Import this package with:</p>
<div class="fragment"><div class="line">from <a class="code hl_namespace" href="namespacegnuradio.html">gnuradio</a> <span class="keyword">import</span> audio</div>
<div class="ttc" id="anamespacegnuradio_html"><div class="ttname"><a href="namespacegnuradio.html">gnuradio</a></div><div class="ttdef"><b>Definition</b> sptr_magic.h:26</div></div>
</div><!-- fragment --><p>See the Doxygen documentation for details about the blocks available in this package. A quick listing of the details can be found in Python after importing by using:</p>
<div class="fragment"><div class="line">help(audio)</div>
</div><!-- fragment --><h1><a class="anchor" id="audio_usage"></a>
Usage</h1>
<p>For an audio source, a typical ArgumentParser option and it's use looks like:</p>
<div class="fragment"><div class="line">parser.add_argument(<span class="stringliteral">&quot;-O&quot;</span>, <span class="stringliteral">&quot;--audio-output&quot;</span>, <span class="keywordflow">default</span>=<span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                   help=<span class="stringliteral">&quot;pcm device name.  E.g., hw:0,0 or surround51 or /dev/dsp&quot;</span>)</div>
<div class="line">audio_rate = 32e3</div>
<div class="line">audio_sink = audio.sink (<span class="keywordtype">int</span> (audio_rate), options.audio_output)</div>
</div><!-- fragment --><p>Similarly, an audio sink would have a typical ArgumentParser option and its use would look like:</p>
<div class="fragment"><div class="line">parser.add_argument(<span class="stringliteral">&quot;-I&quot;</span>, <span class="stringliteral">&quot;--audio-input&quot;</span>, <span class="keywordflow">default</span>=<span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                  help=<span class="stringliteral">&quot;pcm input device name.  E.g., hw:0,0 or /dev/dsp&quot;</span>)</div>
<div class="line">audio_rate = 32e3</div>
<div class="line">audio_source = audio.source(<span class="keywordtype">int</span>(audio_rate), audio_input)</div>
</div><!-- fragment --><h1><a class="anchor" id="audio_adding"></a>
Adding a New Audio Machine</h1>
<p>There may come a time when we need to define a new audio machine type besides those currently supported. To do this, we have to follow a simple pattern to add it to the list of potential machines GNU Radio can use.</p>
<ol type="1">
<li>Add a new directory in gr-audio/lib for the new machine name, like the alsa, oss, etc. that are already there.</li>
<li>Follow the pattern of the other machines to create the class structure for both a source and sink implementation for the machine.</li>
<li>Make sure to add the factory function for both the new source and sink classes. Like in the ALSA sink case, we have:</li>
</ol>
<div class="fragment"><div class="line">sink::sptr</div>
<div class="line">alsa_sink_fcn(<span class="keywordtype">int</span> sampling_rate,</div>
<div class="line">              <span class="keyword">const</span> std::string &amp;device_name,</div>
<div class="line">              <span class="keywordtype">bool</span> ok_to_block)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span> sink::sptr</div>
<div class="line">    (<span class="keyword">new</span> alsa_sink(sampling_rate, device_name, ok_to_block));</div>
<div class="line">}</div>
</div><!-- fragment --><ol type="1">
<li>Add the new source and sink factory functions to the audio registration list in gr-audio/lib/audio_registry.cc and audio_registry.h files. Select the appropriate registry priority, HIGH if you want this to be the default when using 'auto'. For Linux audio systems, we generally want to default to ALSA, fall back on OSS, but have other machine interfaces defined as MED priority. For example, in the .cc file for ALSA, OSS, and PortAudio:</li>
</ol>
<div class="fragment"><div class="line"><span class="preprocessor">#ifdef ALSA_FOUND</span></div>
<div class="line">        s_registry.push_back(register_source(REG_PRIO_HIGH, <span class="stringliteral">&quot;alsa&quot;</span>, alsa_source_fcn));</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* ALSA_FOUND */</span><span class="preprocessor"></span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef OSS_FOUND</span></div>
<div class="line">        s_registry.push_back(register_source(REG_PRIO_LOW, <span class="stringliteral">&quot;oss&quot;</span>, oss_source_fcn));</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* OSS_FOUND */</span><span class="preprocessor"></span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PORTAUDIO_FOUND</span></div>
<div class="line">        s_registry.push_back(register_source(REG_PRIO_MED, <span class="stringliteral">&quot;portaudio&quot;</span>, portaudio_source_fcn));</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* PORTAUDIO_FOUND */</span><span class="preprocessor"></span></div>
</div><!-- fragment --><ol type="1">
<li>Follow the examples in the gr-audio/lib/CMakeLists.txt file for the different machine types to add the new one, including the add_definitions to provide the new YOURMACH_FOUND used in the audio_registry files. </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
